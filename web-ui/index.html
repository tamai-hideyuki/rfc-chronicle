<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ffffff">
    <title>RFC Chronicle Web UI</title>
</head>
<body>
<h1>RFC Chronicle CLI Web UI</h1>

<!-- 初期メタデータ表示 -->
<pre id="app">読み込み中...</pre>

<!-- 検索フォーム -->
<div>
    <input type="text" id="search-input" placeholder="検索クエリを入力" />
    <button id="search-btn">検索</button>
</div>
<pre id="results">検索結果がここに表示されます</pre>

<script>
    // 初期メタデータ取得
    async function fetchMetadata() {
        try {
            const res = await fetch('/api/metadata');
            if (!res.ok) throw new Error(res.status + ' ' + res.statusText);
            const data = await res.json();
            document.getElementById('app').textContent = JSON.stringify(data, null, 2);
        } catch (err) {
            document.getElementById('app').textContent = 'エラー: ' + err;
        }
    }

    // 検索実行
    document.getElementById('search-btn').addEventListener('click', async () => {
        const q = document.getElementById('search-input').value;
        const resultsEl = document.getElementById('results');
        resultsEl.textContent = '検索中...';
        try {
            const res = await fetch(`/api/search?q=${encodeURIComponent(q)}`);
            if (!res.ok) throw new Error(res.status + ' ' + res.statusText);
            const data = await res.json();
            resultsEl.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
            resultsEl.textContent = 'エラー: ' + err;
        }
    });

    // ページ読み込み時に最初のデータ取得
    fetchMetadata();
</script>
</body>
</html>
